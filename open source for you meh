--if you edit, leave the credits pls S2

local NotificationLib = {}

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Limpar GUI existente de forma segura
pcall(function()
    local existingGui = playerGui:FindFirstChild("NotificationGui")
    if existingGui then
        existingGui:Destroy()
    end
end)

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NotificationGui"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = playerGui

local container = Instance.new("Frame")
container.Name = "NotificationContainer"
container.Size = UDim2.new(0, 300, 1, 0)
container.Position = UDim2.new(1, -310, 0, 10)
container.BackgroundTransparency = 1
container.Parent = screenGui

local activeNotifications = {}

local function atualizarPosicoes()
    local currentY = 0
    for _, n in ipairs(activeNotifications) do
        if n and n.Parent then
            pcall(function()
                local tweenPos = TweenService:Create(n, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                    Position = UDim2.new(0, 0, 0, currentY)
                })
                tweenPos:Play()
            end)
            currentY = currentY + n.Size.Y.Offset + 10
        end
    end
end

local function criarNotificacao(titulo, mensagem, duracao, cor)
    -- Validação de parâmetros
    titulo = tostring(titulo or "Notificação")
    mensagem = tostring(mensagem or "")
    duracao = tonumber(duracao) or 5
    cor = cor or Color3.fromRGB(52, 152, 219)
    
    -- Limitar duração
    duracao = math.clamp(duracao, 1, 60)
    
    local notif = Instance.new("Frame")
    notif.Size = UDim2.new(1, 0, 0, 80)
    notif.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    notif.BorderSizePixel = 0
    notif.ClipsDescendants = true

    local barra = Instance.new("Frame")
    barra.Size = UDim2.new(0, 4, 1, 0)
    barra.BackgroundColor3 = cor
    barra.BorderSizePixel = 0
    barra.Parent = notif
    
    local tituloLabel = Instance.new("TextLabel")
    tituloLabel.Size = UDim2.new(1, -50, 0, 25)
    tituloLabel.Position = UDim2.new(0, 15, 0, 8)
    tituloLabel.BackgroundTransparency = 1
    tituloLabel.Text = titulo
    tituloLabel.Font = Enum.Font.GothamBold
    tituloLabel.TextSize = 16
    tituloLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    tituloLabel.TextXAlignment = Enum.TextXAlignment.Left
    tituloLabel.TextTruncate = Enum.TextTruncate.AtEnd
    tituloLabel.Parent = notif
    
    local mensagemLabel = Instance.new("TextLabel")
    mensagemLabel.Size = UDim2.new(1, -50, 0, 40)
    mensagemLabel.Position = UDim2.new(0, 15, 0, 35)
    mensagemLabel.BackgroundTransparency = 1
    mensagemLabel.Text = mensagem
    mensagemLabel.Font = Enum.Font.Gotham
    mensagemLabel.TextSize = 14
    mensagemLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    mensagemLabel.TextXAlignment = Enum.TextXAlignment.Left
    mensagemLabel.TextYAlignment = Enum.TextYAlignment.Top
    mensagemLabel.TextWrapped = true
    mensagemLabel.Parent = notif
    
    local btnFechar = Instance.new("TextButton")
    btnFechar.Size = UDim2.new(0, 30, 0, 30)
    btnFechar.Position = UDim2.new(1, -35, 0, 5)
    btnFechar.BackgroundTransparency = 1
    btnFechar.Text = "×"
    btnFechar.Font = Enum.Font.GothamBold
    btnFechar.TextSize = 20
    btnFechar.TextColor3 = Color3.fromRGB(150, 150, 150)
    btnFechar.AutoButtonColor = false
    btnFechar.Parent = notif
    
    local uiCorner = Instance.new("UICorner")
    uiCorner.CornerRadius = UDim.new(0, 8)
    uiCorner.Parent = notif
    
    local uiStroke = Instance.new("UIStroke")
    uiStroke.Color = Color3.fromRGB(50, 50, 50)
    uiStroke.Thickness = 1
    uiStroke.Parent = notif
    
    -- Calcular posição inicial
    local yPos = 0
    for _, n in ipairs(activeNotifications) do
        if n and n.Parent then
            yPos = yPos + n.Size.Y.Offset + 10
        end
    end
    notif.Position = UDim2.new(0, 0, 0, yPos)
    notif.Parent = container
    
    table.insert(activeNotifications, notif)
    
    -- Animação de entrada
    notif.Size = UDim2.new(1, 0, 0, 0)
    local tweenIn = TweenService:Create(notif, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Size = UDim2.new(1, 0, 0, 80)
    })
    tweenIn:Play()
    
    local isRemoving = false
    local function removerNotificacao()
        if isRemoving then return end
        isRemoving = true
        
        if not notif or not notif.Parent then return end
        
        local tweenOut = TweenService:Create(notif, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Size = UDim2.new(1, 0, 0, 0)
        })
        tweenOut:Play()
        tweenOut.Completed:Connect(function()
            -- Remover da lista
            for i, n in ipairs(activeNotifications) do
                if n == notif then
                    table.remove(activeNotifications, i)
                    break
                end
            end
            
            -- Atualizar posições
            atualizarPosicoes()
            
            -- Destruir notificação
            if notif and notif.Parent then
                notif:Destroy()
            end
        end)
    end
    
    -- Hover effect no botão
    btnFechar.MouseEnter:Connect(function()
        if not isRemoving then
            btnFechar.TextColor3 = Color3.fromRGB(255, 255, 255)
        end
    end)
    
    btnFechar.MouseLeave:Connect(function()
        if not isRemoving then
            btnFechar.TextColor3 = Color3.fromRGB(150, 150, 150)
        end
    end)
    
    btnFechar.MouseButton1Click:Connect(removerNotificacao)
    
    -- Auto-remover após duração
    task.delay(duracao, function()
        removerNotificacao()
    end)
end

-- Funções públicas
function NotificationLib:Notificar(titulo, mensagem, duracao)
    criarNotificacao(titulo, mensagem, duracao, Color3.fromRGB(52, 152, 219))
end

function NotificationLib:Sucesso(titulo, mensagem, duracao)
    criarNotificacao(titulo, mensagem, duracao, Color3.fromRGB(46, 204, 113))
end

function NotificationLib:Erro(titulo, mensagem, duracao)
    criarNotificacao(titulo, mensagem, duracao, Color3.fromRGB(231, 76, 60))
end

function NotificationLib:Aviso(titulo, mensagem, duracao)
    criarNotificacao(titulo, mensagem, duracao, Color3.fromRGB(241, 196, 15))
end

function NotificationLib:Info(titulo, mensagem, duracao)
    criarNotificacao(titulo, mensagem, duracao, Color3.fromRGB(52, 152, 219))
end

function NotificationLib:Custom(titulo, mensagem, duracao, cor)
    criarNotificacao(titulo, mensagem, duracao, cor)
end

function NotificationLib:LimparTudo()
    for _, notif in ipairs(activeNotifications) do
        if notif and notif.Parent then
            notif:Destroy()
        end
    end
    activeNotifications = {}
end

return NotificationLib
